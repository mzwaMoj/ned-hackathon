<begin transaction history metadata>

# Database Schema Information

## Database Details
- **Database**: SQL Server (master)
- **Server**: localhost\SQLEXPRESS
- **Schema**: dbo

## Table: transaction_history
Comprehensive transaction history table containing all customer financial transactions including deposits, withdrawals, transfers, payments, and purchases

### Table Structure
**Full Name**: [dbo].[transaction_history]
**Records**: 5000+ transactions
**Primary Key**: transaction_id
**Foreign Keys**: customer_id
**Time Range**: Last 2 years of transaction data

### Column Definitions

**transaction_id** (bigint)
- Description: Unique transaction identifier, 12-digit number
- Range: 100000000000 to 999999999999
- Examples: 679551814302, 376513881618, 994709101726
- Rules: Auto-generated unique identifier for each transaction

**customer_id** (int)
- Description: Customer identifier linking to customer_information table
- Range: 10000000 to 99999999
- Examples: 10000001, 10000002, 10000003
- Rules: Must exist in customer_information table

**transaction_date** (datetime)
- Description: Date and time when the transaction occurred
- Examples: 2023-06-15 14:30:22, 2024-11-28 09:15:45, 2025-01-12 16:45:33
- Rules: Cannot be future date, used for transaction ordering and reporting

**transaction_type** (nvarchar)
- Description: Type of transaction performed
- Valid Values: Deposit, Withdrawal, Transfer, Payment, Purchase, Refund, Fee, Interest, Loan Payment, Salary
- Examples: Deposit, Withdrawal, Transfer
- Rules: Determines transaction processing rules and account impact

**amount** (decimal)
- Description: Transaction amount in specified currency (negative for debits, positive for credits)
- Range: -100000.00 to 100000.00
- Examples: 1500.5, -89.99, 25000.0
- Rules: Negative values represent debits (withdrawals, payments, fees), positive values represent credits (deposits, refunds, interest)

**currency** (nvarchar)
- Description: ISO 4217 currency code for the transaction
- Valid Values: ZAR, USD, EUR, GBP, JPY
- Examples: ZAR, USD, EUR
- Rules: Primarily ZAR (85%), with some international currencies for forex transactions

**description** (nvarchar)
- Description: Human-readable description of the transaction
- Examples: Groceries purchase at Woolworths, Transfer to John Smith, Salary payment from ABC Corp
- Rules: Auto-generated based on transaction type and context

**category** (nvarchar)
- Description: Transaction category for spending analysis
- Valid Values: Groceries, Gas, Restaurant, Shopping, Utilities, Healthcare, Entertainment, Travel, Education, Insurance, Banking, Investment, Salary, Bonus, Refund, Other
- Examples: Groceries, Gas, Restaurant
- Rules: Used for budgeting and spending pattern analysis

**channel** (nvarchar)
- Description: Channel through which the transaction was made
- Valid Values: ATM, Online Banking, Mobile App, Branch, POS Terminal, Wire Transfer, ACH, Check, Direct Deposit
- Examples: ATM, Online Banking, Mobile App
- Rules: Tracks customer behavior and channel preference

**status** (nvarchar)
- Description: Current status of the transaction
- Valid Values: Completed, Pending, Failed, Cancelled
- Examples: Completed, Pending, Failed
- Rules: Only Completed transactions affect account balance

**reference_number** (nvarchar)
- Description: Unique reference number for transaction tracking
- Examples: REF1234AB5678, REF9876XY1234
- Rules: Used for transaction inquiries and dispute resolution
- Pattern: REF####??####

**merchant_name** (nvarchar)
- Description: Name of merchant for purchase and payment transactions
- Examples: Woolworths, Shell Garage, Amazon
- Rules: Only populated for Purchase and Payment transaction types

**merchant_category** (nvarchar)
- Description: Category of merchant for purchase and payment transactions
- Examples: Groceries, Gas, Shopping
- Rules: Matches category field for Purchase and Payment transactions

**account_from** (nvarchar)
- Description: Source account number for the transaction
- Examples: 1234567890, 9876543210
- Rules: 10-digit account number, links to customer's account

**account_to** (nvarchar)
- Description: Destination account number for transfer transactions
- Examples: 5555666677, 1111222233
- Rules: Only populated for Transfer transaction types

**balance_after** (decimal)
- Description: Account balance after the transaction was processed
- Range: 0.00 to 100000.00
- Examples: 15420.5, 8750.25, 45000.0
- Rules: Snapshot of balance immediately after transaction completion

**location** (nvarchar)
- Description: Geographic location where the transaction occurred
- Examples: Johannesburg, South Africa, Cape Town, South Africa, London, United Kingdom
- Rules: Used for fraud detection and geographic spending analysis

**created_at** (datetime)
- Description: Timestamp when the transaction record was created in the system
- Examples: 2025-06-09 10:30:22, 2025-06-09 11:15:45
- Rules: System audit field, automatically populated

**updated_at** (datetime)
- Description: Timestamp when the transaction record was last updated
- Examples: 2025-06-09 10:30:22, 2025-06-09 11:15:45
- Rules: System audit field, automatically updated on changes

### Key Relationships & Rules

- **customer_id** references **customer_information.id**: Each transaction belongs to one customer, customers can have many transactions
- **merchant_name** depends on **transaction_type**: merchant_name is only populated when transaction_type is 'Purchase' or 'Payment'
- **account_to** depends on **transaction_type**: account_to is only populated when transaction_type is 'Transfer'
- **Amount Sign Convention**: Negative amounts for debits (Withdrawal, Payment, Purchase, Fee, Loan Payment), positive for credits (Deposit, Salary, Interest, Refund)
- **Status Constraint**: balance_after only reflects completed transactions, not pending/failed ones

</end transaction history metadata>
